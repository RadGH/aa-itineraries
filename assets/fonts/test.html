<!DOCTYPE html>
<html>
<head>
	<base href="https://alpinehikerdev.wpengine.com/">
	
	<script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
	
	<style>
		html, body { padding: 0; }
		body { background: #888;  }
		.section-image { text-align: center; margin-bottom: 30px; }
	
		.pdf-page {
			position: relative; /* REQUIRED */
			
			width: 1055px;
			height: 815px;
			display: block;
			margin: 0 auto 40px;
			background: #fff;
		}

		.pdf-columns {
			columns: 2;
			column-count: 2;
			display: grid;
			grid-template-columns: 1fr 1fr;
		}
	</style>
</head>
<body>
<div class="pdf-container">
	<div class="pdf-page">
	
	<section id="village-grindelwald" class="pdf-section village village-grindelwald village-id-6273">
		
			
			<div class="section-heading">
				<h1 class="pdf-title">Page Title</h1>
				<h2 class="pdf-subtitle">Page Subtitle</h2>
				<div class="clear"></div>
			</div>
			
			<div class="section-image">
				<img src="https://dummyimage.com/600x360/000/fff" class="ah-image" width="600" height="360" alt="chrome_2023-03-20_22-23-04">
			</div>
			
			<div class="section-content">
				<div class="pdf-columns pdf-fit-content">
					<p>1. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin placerat lorem id mi efficitur sodales. In vel orci non nulla tincidunt venenatis non vel orci. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum accumsan nec magna ac aliquam. Proin accumsan efficitur libero, at pharetra lectus varius et. Sed id urna et mi varius hendrerit non sit amet orci. Nullam pretium est in est elementum, quis laoreet orci auctor. Nam lacus dolor, elementum ut aliquam a, imperdiet in purus. Etiam ultrices semper fringilla. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; In hac habitasse platea dictumst.</p>
					<p>2. Aenean et erat condimentum, ultrices felis in, auctor urna. Vestibulum blandit, est nec fringilla pharetra, felis eros dignissim enim, quis eleifend enim dui eget massa. Maecenas ornare semper massa. Nam nisl dolor, elementum nec diam in, ultrices consectetur turpis. Mauris posuere posuere nunc, ut hendrerit augue ornare eget. Sed tempor vitae elit sed faucibus. Nunc nisl augue, ornare sed convallis sed, pretium eget eros. Suspendisse augue quam, ullamcorper non iaculis a, varius id tellus. Sed eu feugiat lectus, at tempor tellus. Nulla varius turpis euismod tortor hendrerit sollicitudin. Sed tristique neque a metus faucibus, vitae ornare ex commodo. Vestibulum tincidunt varius magna, eget vulputate mi placerat sit amet.</p>
					<p>3. Vestibulum tellus odio, pellentesque id mauris eget, placerat mattis nunc. Aliquam maximus egestas nunc, ac ullamcorper purus scelerisque et. Donec lacinia dictum est sed tincidunt. Maecenas facilisis erat metus, non vestibulum enim pharetra non. Aliquam quis aliquet arcu. Proin volutpat leo a ligula faucibus, vel dapibus nulla tincidunt. Pellentesque condimentum mi in tortor vehicula tincidunt. Proin facilisis odio augue, vel semper dui elementum sollicitudin. Nunc eget finibus sem, id egestas ex. Integer nec est ut est porta mollis ac eu eros. Fusce facilisis iaculis mauris, congue congue nunc. Nam cursus nisl et libero fringilla porta. Nunc sed bibendum quam. Pellentesque quam dui, auctor commodo sem ut, blandit bibendum dolor. Phasellus ullamcorper metus a semper consectetur. Cras convallis felis et nisl auctor, vel feugiat diam efficitur.</p>
					<p>4. Phasellus dictum iaculis dignissim. Etiam feugiat pulvinar dolor vitae pretium. Donec cursus felis enim, id accumsan turpis pulvinar in. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nulla eros lorem, porttitor sed eros eget, rhoncus tristique tortor. Sed pulvinar lorem quis ante dignissim laoreet. Maecenas eget massa aliquam, convallis dolor quis, aliquam libero. Nunc fringilla diam ut odio vestibulum lacinia. Etiam euismod lacus venenatis, imperdiet turpis ut, auctor massa. Phasellus felis arcu, cursus in venenatis sed, cursus blandit risus. Mauris nulla magna, convallis a lectus lobortis, laoreet iaculis nibh. Ut nisi nulla, consectetur vitae gravida eu, fermentum fermentum urna. Mauris sagittis metus at euismod pharetra. Nullam ut lectus tortor.</p>
					<p>5. Proin dignissim a justo non imperdiet. Etiam lacinia est sit amet tellus vehicula varius eu eget dolor. Phasellus metus mauris, pulvinar vitae ipsum in, tincidunt suscipit lacus. Fusce vitae mauris neque. Cras interdum arcu pulvinar, convallis erat ac, accumsan diam. Aenean dapibus dictum odio, sed iaculis neque. Cras dapibus augue ut commodo porta. Vestibulum elementum finibus faucibus.</p>
					<p>6. Ut euismod ligula in metus dictum, eu dapibus ipsum lobortis. Duis tempor metus feugiat, mattis purus et, pharetra felis. Curabitur a dignissim elit. Ut convallis est nec augue fringilla, ut finibus massa lacinia. Curabitur sit amet turpis dolor. Aliquam sed vulputate magna. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Vestibulum accumsan tortor lorem, eu rutrum nisl ultrices in.</p>
					<p>7. Quisque elit lectus, pharetra eget condimentum porttitor, luctus quis urna. Vivamus accumsan odio at nisl dignissim, accumsan faucibus ante tempus. Etiam consequat tortor sit amet neque pharetra lobortis. Sed sed est sit amet eros elementum volutpat. Donec mattis nisl sit amet lorem dapibus consequat. Mauris cursus eu libero at dignissim. Praesent congue sapien tortor, posuere bibendum sem rutrum varius. Aenean non felis non urna sollicitudin posuere non eget velit.</p>
					<p>8. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Nam at turpis scelerisque, porta tellus et, egestas ex. Pellentesque condimentum lobortis enim in fermentum. Fusce nec tempor tortor. Sed vitae velit dolor. Proin scelerisque sem tortor, ac sodales dolor eleifend sit amet. Praesent ullamcorper nisl in molestie imperdiet. Nunc accumsan dui consequat elit dictum, eu rutrum ligula posuere. Nulla facilisi. Etiam vitae ligula id eros aliquet pellentesque. Pellentesque a ex dui. Nullam in diam ex.</p>
					<p>9. Quisque ullamcorper nulla risus, in maximus massa sodales in. Nullam condimentum dui eu dui ullamcorper, sed suscipit ante faucibus. Ut blandit leo et ante rutrum, vel hendrerit purus tempor. Aenean feugiat accumsan lacus, sit amet interdum lacus elementum sed. In nibh urna, dapibus quis quam non, faucibus porttitor lectus. Ut et urna convallis, gravida nunc sit amet, rutrum sem. Vestibulum convallis vestibulum lacus. Nullam elementum posuere felis, vitae maximus mauris lacinia vitae. Proin mi neque, pulvinar ac accumsan sed, tincidunt et nibh. Suspendisse interdum molestie lorem id vestibulum. Sed quis enim pellentesque, pulvinar lectus sed, tristique nulla. Phasellus ac nulla blandit, sagittis neque a, tincidunt urna. Morbi purus sapien, interdum ac efficitur eget, interdum nec massa.</p>
					<p>10. Sed ut tristique erat. Vestibulum quis vestibulum erat, ut sollicitudin felis. Nunc nec aliquet odio. Sed nec nisi eu nisi suscipit efficitur sit amet nec sem. Sed et risus consequat, molestie lorem ac, venenatis elit. Integer lorem sem, accumsan sed mollis eu, pretium id odio. Ut dui magna, malesuada non volutpat nec, viverra ac nunc. Donec nec neque eu leo placerat ullamcorper et vel turpis. Maecenas tincidunt risus eget leo ornare, in lacinia mauris dignissim. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Morbi quis luctus nibh. Sed feugiat tellus nec neque dictum luctus. Sed iaculis justo mi, vitae iaculis nulla posuere ut. Donec vestibulum tristique nunc at vestibulum. Ut eu elit leo.</p>
				</div>
			</div>
			
			<div class="section-content">
				<h2>Heading for some more text</h2>
				<div class="pdf-columns pdf-fit-content">
					<p>1. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin placerat lorem id mi efficitur sodales. In vel orci non nulla tincidunt venenatis non vel orci. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum accumsan nec magna ac aliquam. Proin accumsan efficitur libero, at pharetra lectus varius et. Sed id urna et mi varius hendrerit non sit amet orci. Nullam pretium est in est elementum, quis laoreet orci auctor. Nam lacus dolor, elementum ut aliquam a, imperdiet in purus. Etiam ultrices semper fringilla. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; In hac habitasse platea dictumst.</p>
					<p>2. Aenean et erat condimentum, ultrices felis in, auctor urna. Vestibulum blandit, est nec fringilla pharetra, felis eros dignissim enim, quis eleifend enim dui eget massa. Maecenas ornare semper massa. Nam nisl dolor, elementum nec diam in, ultrices consectetur turpis. Mauris posuere posuere nunc, ut hendrerit augue ornare eget. Sed tempor vitae elit sed faucibus. Nunc nisl augue, ornare sed convallis sed, pretium eget eros. Suspendisse augue quam, ullamcorper non iaculis a, varius id tellus. Sed eu feugiat lectus, at tempor tellus. Nulla varius turpis euismod tortor hendrerit sollicitudin. Sed tristique neque a metus faucibus, vitae ornare ex commodo. Vestibulum tincidunt varius magna, eget vulputate mi placerat sit amet.</p>
					<p>3. Vestibulum tellus odio, pellentesque id mauris eget, placerat mattis nunc. Aliquam maximus egestas nunc, ac ullamcorper purus scelerisque et. Donec lacinia dictum est sed tincidunt. Maecenas facilisis erat metus, non vestibulum enim pharetra non. Aliquam quis aliquet arcu. Proin volutpat leo a ligula faucibus, vel dapibus nulla tincidunt. Pellentesque condimentum mi in tortor vehicula tincidunt. Proin facilisis odio augue, vel semper dui elementum sollicitudin. Nunc eget finibus sem, id egestas ex. Integer nec est ut est porta mollis ac eu eros. Fusce facilisis iaculis mauris, congue congue nunc. Nam cursus nisl et libero fringilla porta. Nunc sed bibendum quam. Pellentesque quam dui, auctor commodo sem ut, blandit bibendum dolor. Phasellus ullamcorper metus a semper consectetur. Cras convallis felis et nisl auctor, vel feugiat diam efficitur.</p>
					<p>4. Phasellus dictum iaculis dignissim. Etiam feugiat pulvinar dolor vitae pretium. Donec cursus felis enim, id accumsan turpis pulvinar in. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nulla eros lorem, porttitor sed eros eget, rhoncus tristique tortor. Sed pulvinar lorem quis ante dignissim laoreet. Maecenas eget massa aliquam, convallis dolor quis, aliquam libero. Nunc fringilla diam ut odio vestibulum lacinia. Etiam euismod lacus venenatis, imperdiet turpis ut, auctor massa. Phasellus felis arcu, cursus in venenatis sed, cursus blandit risus. Mauris nulla magna, convallis a lectus lobortis, laoreet iaculis nibh. Ut nisi nulla, consectetur vitae gravida eu, fermentum fermentum urna. Mauris sagittis metus at euismod pharetra. Nullam ut lectus tortor.</p>
					<p>5. Proin dignissim a justo non imperdiet. Etiam lacinia est sit amet tellus vehicula varius eu eget dolor. Phasellus metus mauris, pulvinar vitae ipsum in, tincidunt suscipit lacus. Fusce vitae mauris neque. Cras interdum arcu pulvinar, convallis erat ac, accumsan diam. Aenean dapibus dictum odio, sed iaculis neque. Cras dapibus augue ut commodo porta. Vestibulum elementum finibus faucibus.</p>
					<p>6. Ut euismod ligula in metus dictum, eu dapibus ipsum lobortis. Duis tempor metus feugiat, mattis purus et, pharetra felis. Curabitur a dignissim elit. Ut convallis est nec augue fringilla, ut finibus massa lacinia. Curabitur sit amet turpis dolor. Aliquam sed vulputate magna. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Vestibulum accumsan tortor lorem, eu rutrum nisl ultrices in.</p>
					<p>7. Quisque elit lectus, pharetra eget condimentum porttitor, luctus quis urna. Vivamus accumsan odio at nisl dignissim, accumsan faucibus ante tempus. Etiam consequat tortor sit amet neque pharetra lobortis. Sed sed est sit amet eros elementum volutpat. Donec mattis nisl sit amet lorem dapibus consequat. Mauris cursus eu libero at dignissim. Praesent congue sapien tortor, posuere bibendum sem rutrum varius. Aenean non felis non urna sollicitudin posuere non eget velit.</p>
					<p>8. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Nam at turpis scelerisque, porta tellus et, egestas ex. Pellentesque condimentum lobortis enim in fermentum. Fusce nec tempor tortor. Sed vitae velit dolor. Proin scelerisque sem tortor, ac sodales dolor eleifend sit amet. Praesent ullamcorper nisl in molestie imperdiet. Nunc accumsan dui consequat elit dictum, eu rutrum ligula posuere. Nulla facilisi. Etiam vitae ligula id eros aliquet pellentesque. Pellentesque a ex dui. Nullam in diam ex.</p>
					<p>9. Quisque ullamcorper nulla risus, in maximus massa sodales in. Nullam condimentum dui eu dui ullamcorper, sed suscipit ante faucibus. Ut blandit leo et ante rutrum, vel hendrerit purus tempor. Aenean feugiat accumsan lacus, sit amet interdum lacus elementum sed. In nibh urna, dapibus quis quam non, faucibus porttitor lectus. Ut et urna convallis, gravida nunc sit amet, rutrum sem. Vestibulum convallis vestibulum lacus. Nullam elementum posuere felis, vitae maximus mauris lacinia vitae. Proin mi neque, pulvinar ac accumsan sed, tincidunt et nibh. Suspendisse interdum molestie lorem id vestibulum. Sed quis enim pellentesque, pulvinar lectus sed, tristique nulla. Phasellus ac nulla blandit, sagittis neque a, tincidunt urna. Morbi purus sapien, interdum ac efficitur eget, interdum nec massa.</p>
					<p>10. Sed ut tristique erat. Vestibulum quis vestibulum erat, ut sollicitudin felis. Nunc nec aliquet odio. Sed nec nisi eu nisi suscipit efficitur sit amet nec sem. Sed et risus consequat, molestie lorem ac, venenatis elit. Integer lorem sem, accumsan sed mollis eu, pretium id odio. Ut dui magna, malesuada non volutpat nec, viverra ac nunc. Donec nec neque eu leo placerat ullamcorper et vel turpis. Maecenas tincidunt risus eget leo ornare, in lacinia mauris dignissim. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Morbi quis luctus nibh. Sed feugiat tellus nec neque dictum luctus. Sed iaculis justo mi, vitae iaculis nulla posuere ut. Donec vestibulum tristique nunc at vestibulum. Ut eu elit leo.</p>
				</div>
			</div>
		
	</section>
	
	</div>
	
</div>

<script type="text/javascript">
	jQuery( '.pdf-page').css('background', 'yellow' );
</script>
<script type="text/javascript">
(function() {

var $current_page = null;
var $current_container = null;

var create_page = function() {
	return jQuery('<div class="pdf-page"></div>');
}

var rebuild_page_structure = function( $structure ) {
	var $new_page = create_page();

	var $container = jQuery('<div>');

	$new_page.append( $container );

	if ( $structure.length > 0 ) {
		$structure.each(function() {
			var node_name = this.nodeName;
			var class_list = this.classList;
			var $el = jQuery( '<'+ node_name +'>', { class: class_list });

			$container.append( $el );
			$container = $el;
		});
	}

	return [ $new_page, $container ]; // $container ];
}

var get_area = function( $element ) {
	var pos = $element.position();
	var h = $element.height();
	return {
		top: Math.round( pos.top ),
		height: Math.round( h ),
		bottom: Math.round( pos.top + h )
	};
}

var append_to_container = function( $container, $element ) {
	console.log('Appending element', $element[0]);
	$container.append( $element );
};

var recursive_add = function( $container, $elements, page_height, depth ) {

	$current_container = $container;
	
	$elements.detach();

	$elements.each(function() {

		var $e = jQuery(this);

		var $e_children = $e.children();
		
		// Add element to current container
		append_to_container( $current_container, $e );

		if ( $e_children.length > 0 ) {
			
			// This element has children element, split those up too
			// Split children of the container
			recursive_add( $e, $e_children, page_height, depth + 1 );

			return;

		}

		// Check if we need to add another page
		var area = get_area( $current_container );

		if ( area.bottom > page_height ) {

			// Add a new page with the existing element structure
			var $structure = $current_container.is('.pdf-page') ? $current_container : $current_container.parentsUntil( '.pdf-page' ).add($current_container);
			
			console.log('Building structure ', $structure, ' for ', $e[0] );
			var struct = rebuild_page_structure( $structure );

			// Use a new page and container from here onward
			var $new_page = struct[0];
			$current_container = struct[1];

			$current_page.after( $new_page );
			
			console.log('Starting new page', $new_page[0]);
			$current_page = $new_page;

			// Add the element to the new page
			append_to_container( $current_container, $e );

		}

	});

	console.log( 'Done adding elements at depth ' + depth );
};

// 1. Split up pages when the contents are too tall to fit on one page.
// 2. Add children elements one at a time until the page height is too much, then start a new page
// 3. Repeat #2 until all elements have been added.
jQuery('.pdf-page').each(function() {
	$current_page = jQuery(this);
	$current_container = $current_page;
	var $children = $current_page.children();
	var page_height = jQuery(this).height();

	$children.detach();
	
	recursive_add( $current_container, $children, page_height, 0 );
	
});

})();
</script>

</body>
</html>
